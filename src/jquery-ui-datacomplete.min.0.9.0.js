(function(b){var h=0,i=0;b.widget("ui.datacomplete",b.ui.autocomplete,{options:{autoFocus:!0,minLength:0,scrollHeight:400,position:{my:"right top",at:"right bottom",collision:"none"},extraData:null,columns:null,submitForm:!1,select:function(a,c){var e=b(this).data("datacomplete").options;if(e.extraData)for(var g=0;g<e.extraData.length;g++){var d=e.extraData[g].ws,f=e.extraData[g].dom;d&&f&&(f="#"+f,d=c.item[d],f=b(f),d&&f&&f.attr("value",d))}i=!0},close:function(){if(i){var a=b(this).data("datacomplete").options;
a.submitForm&&(a=b("#"+a.submitForm))&&a.submit()}}},_initSource:function(){var a=this,c,e;b.isArray(this.options.source)?(c=this.options.source,this.source=function(a,d){d(b.ui.autocomplete.filter(c,a.term))}):typeof this.options.source==="string"?(e=this.options.source,this.source=function(c,d){a.xhr&&a.xhr.abort();this.options.extraParams&&b.each(this.options.extraParams,function(a,b){if(b==null){if((b=document.getElementById(a))&&b.length>0)c[a]=b.value}else c[a]=b});a.xhr=b.ajax({url:e,data:c,
dataType:"json",autocompleteRequest:++h,success:function(a){this.autocompleteRequest===h&&d(a)},error:function(){this.autocompleteRequest===h&&d([])}})}):this.source=this.options.source},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+2,this.element.outerWidth()))},_renderMenu:function(a,c){var e=this;if(this.options.columns&&!c[0].label){var g=b("<li></li>"),d=b("<div class='ui-datacomplete-header clearfix'></div>");g.append(d);for(var f=0;f<this.options.columns.length;f++){var j=
this.options.columns[f];for(key in j){var h=b("<div class='dc-header-"+key+"'>"+j[key]+"</div>");d.append(h)}}a.append(g)}b.each(c,function(b,c){e._renderItem(a,c)})},_renderItem:function(a,c){var e=b("<li></li>").data("item.autocomplete",c),g=b("<a class='clearfix'></a>");e.append(g);if(this.options.columns&&!c.label)for(var d=0;d<this.options.columns.length;d++){var f=this.options.columns[d];for(key in f){var h=b("<div class='dc-"+key+"'>"+c[key]+"</div>");g.append(h)}}else g.append(c.label);e.appendTo(a);
return e},_normalize:function(a){if(a.length&&(this.options.columns||a[0].label)&&a[0].value)return a;return b.map(a,function(a){if(typeof a==="string")return{label:a,value:a};return b.extend({label:a.label||a.value,value:a.value||a.label},a)})},testit:function(){return"scope test"}})})(jQuery);
